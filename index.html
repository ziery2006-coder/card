<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ph·ªèng v·∫•n </title>

<style>
/* ===== VARIABLES & RESET ===== */
:root {
  --primary: #ff4d6d;
  --secondary: #ff9a9e;
  --accent: #7b68ee;
  --light: rgba(255, 255, 255, 0.85);
  --shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

/* ===== MODERN GRADIENT BACKGROUND ===== */
body {
  font-family: 'Segoe UI', 'Comic Sans MS', system-ui, sans-serif;
  min-height: 100vh;
  overflow: hidden;
  background: linear-gradient(135deg, 
    #ffd6e8 0%, 
    #d6f5ff 25%, 
    #e7ffd6 50%, 
    #fff0d6 75%, 
    #f0e6ff 100%);
  background-size: 300% 300%;
  animation: gradientBG 15s ease infinite;
  position: relative;
}

@keyframes gradientBG {
  0% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
  100% { background-position: 0% 50%; }
}

/* Animated particles background */
.particles {
  position: fixed;
  width: 100%;
  height: 100%;
  pointer-events: none;
  z-index: -1;
}

.particle {
  position: absolute;
  background: var(--primary);
  border-radius: 50%;
  opacity: 0.3;
  animation: floatParticle 20s infinite linear;
}

@keyframes floatParticle {
  0% { transform: translateY(100vh) rotate(0deg); }
  100% { transform: translateY(-100px) rotate(360deg); }
}

/* ===== CARD CONTAINER ===== */
.screen {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 90%;
  max-width: 800px;
  min-height: 500px;
  border-radius: 32px;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  backdrop-filter: blur(20px) saturate(180%);
  background: var(--light);
  -webkit-backdrop-filter: blur(20px) saturate(180%);
  border: 1px solid rgba(255, 255, 255, 0.3);
  box-shadow: var(--shadow), 
              0 0 0 1px rgba(255, 255, 255, 0.2) inset;
  text-align: center;
  padding: 40px 30px;
  z-index: 10;
  transition: all 0.6s cubic-bezier(0.4, 0, 0.2, 1);
}

.hidden {
  opacity: 0;
  visibility: hidden;
  pointer-events: none;
  transform: translate(-50%, -50%) scale(0.9);
}

/* ===== TYPOGRAPHY ===== */
h1 {
  font-size: clamp(2.5rem, 5vw, 3.5rem);
  color: var(--primary);
  margin: 20px 0;
  background: linear-gradient(45deg, var(--primary), var(--accent));
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
  text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
}

.message {
  max-width: 600px;
  font-size: clamp(1.1rem, 2vw, 1.3rem);
  line-height: 1.7;
  color: #444;
  margin-bottom: 30px;
  padding: 0 20px;
  position: relative;
}

.message::before, .message::after {
  content: "‚ú®";
  position: absolute;
  opacity: 0.5;
}

.from {
  color: #666;
  margin-bottom: 25px;
  font-size: 1.2rem;
  display: flex;
  align-items: center;
  gap: 10px;
  justify-content: center;
}

/* ===== ANIMATED EMOJI ===== */
.emoji-container {
  display: flex;
  gap: 15px;
  margin: 20px 0;
  flex-wrap: wrap;
  justify-content: center;
}

.animated-emoji {
  font-size: 60px;
  display: inline-block;
  animation: bounce2 2s infinite;
  cursor: pointer;
  transition: transform 0.3s;
}

.animated-emoji:hover {
  transform: scale(1.2) rotate(15deg);
}

@keyframes bounce2 {
  0%, 100% { transform: translateY(0); }
  50% { transform: translateY(-20px); }
}

/* ===== BUTTONS ===== */
.button-group {
  display: flex;
  gap: 20px;
  flex-wrap: wrap;
  justify-content: center;
  margin-top: 20px;
}

button {
  padding: 18px 40px;
  font-size: 1.2rem;
  border: none;
  border-radius: 50px;
  cursor: pointer;
  background: linear-gradient(135deg, var(--primary), var(--secondary));
  color: white;
  box-shadow: 0 10px 25px rgba(255, 77, 109, 0.3);
  transition: all 0.3s ease;
  font-family: inherit;
  font-weight: 600;
  letter-spacing: 0.5px;
  position: relative;
  overflow: hidden;
}

button::before {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
  transition: left 0.7s;
}

button:hover::before {
  left: 100%;
}

button:hover {
  transform: translateY(-5px);
  box-shadow: 0 15px 30px rgba(255, 77, 109, 0.4);
}

button:active {
  transform: translateY(-2px);
}

button.secondary {
  background: linear-gradient(135deg, var(--accent), #9b59b6);
  box-shadow: 0 10px 25px rgba(123, 104, 238, 0.3);
}

/* ===== INPUT ===== */
.input-group {
  margin: 30px 0;
  width: 100%;
  max-width: 500px;
}

input {
  padding: 20px 25px;
  font-size: 1.2rem;
  border-radius: 20px;
  border: 2px solid transparent;
  outline: none;
  width: 100%;
  background: rgba(255, 255, 255, 0.9);
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
  transition: all 0.3s ease;
  font-family: inherit;
}

input:focus {
  border-color: var(--primary);
  box-shadow: 0 8px 25px rgba(255, 77, 109, 0.2);
  transform: translateY(-3px);
}

/* ===== CUSTOM MODAL ===== */
.custom-modal {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(0, 0, 0, 0.7);
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 1000;
  opacity: 0;
  visibility: hidden;
  transition: all 0.3s ease;
}

.custom-modal.active {
  opacity: 1;
  visibility: visible;
}

.modal-content {
  background: white;
  padding: 40px;
  border-radius: 20px;
  max-width: 500px;
  width: 90%;
  text-align: center;
  transform: scale(0.8);
  transition: transform 0.3s ease;
  box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
}

.custom-modal.active .modal-content {
  transform: scale(1);
}

.modal-content h2 {
  color: var(--primary);
  margin-bottom: 20px;
  font-size: 1.8rem;
}

.modal-content p {
  font-size: 1.2rem;
  color: #555;
  margin-bottom: 30px;
  line-height: 1.5;
}

.modal-close {
  background: var(--accent);
  color: white;
  border: none;
  padding: 12px 30px;
  border-radius: 50px;
  font-size: 1.1rem;
  cursor: pointer;
  transition: all 0.3s ease;
}

.modal-close:hover {
  transform: scale(1.05);
  background: #8a6de9;
}

/* ===== SPECIAL EFFECTS ===== */
.confetti {
  position: fixed;
  width: 15px;
  height: 15px;
  pointer-events: none;
  z-index: 100;
  animation: confettiFall 5s linear forwards;
}

@keyframes confettiFall {
  0% {
    transform: translateY(-100px) rotate(0deg);
    opacity: 1;
  }
  100% {
    transform: translateY(100vh) rotate(720deg);
    opacity: 0;
  }
}

.glow-text {
  animation: glow 2s ease-in-out infinite alternate;
}

@keyframes glow {
  from { text-shadow: 0 0 10px rgba(255, 77, 109, 0.5); }
  to { text-shadow: 0 0 20px rgba(255, 77, 109, 0.8), 
                    0 0 30px rgba(255, 77, 109, 0.6); }
}

/* ===== PROGRESS BAR ===== */
.progress-container {
  width: 80%;
  max-width: 400px;
  height: 10px;
  background: rgba(255, 77, 109, 0.1);
  border-radius: 5px;
  margin: 30px 0;
  overflow: hidden;
}

.progress-bar {
  height: 100%;
  background: linear-gradient(90deg, var(--primary), var(--accent));
  border-radius: 5px;
  width: 0%;
  transition: width 1s ease;
}

/* ===== FLOATING HEARTS ===== */
.floating-heart {
  position: absolute;
  font-size: 24px;
  opacity: 0.7;
  animation: floatUp 15s linear infinite;
  pointer-events: none;
}

@keyframes floatUp {
  0% {
    transform: translateY(100vh) rotate(0deg);
    opacity: 0;
  }
  10% {
    opacity: 1;
  }
  90% {
    opacity: 1;
  }
  100% {
    transform: translateY(-100px) rotate(360deg);
    opacity: 0;
  }
}

/* ===== RESPONSIVE DESIGN ===== */
@media (max-width: 768px) {
  .screen {
    width: 95%;
    padding: 30px 20px;
    min-height: 400px;
  }
  
  .button-group {
    flex-direction: column;
    align-items: center;
  }
  
  button {
    width: 100%;
    max-width: 300px;
  }
  
  .animated-emoji {
    font-size: 50px;
  }
  
  .modal-content {
    padding: 30px 20px;
  }
}

@media (max-width: 480px) {
  .screen {
    padding: 25px 15px;
    border-radius: 25px;
  }
  
  h1 {
    font-size: 2rem;
  }
  
  .message {
    font-size: 1rem;
    padding: 0 10px;
  }
  
  input {
    padding: 16px 20px;
    font-size: 1rem;
  }
  
  .modal-content {
    padding: 25px 15px;
  }
  
  .modal-content h2 {
    font-size: 1.5rem;
  }
}

/* ===== LOADING SPINNER ===== */
.spinner {
  border: 4px solid rgba(255, 255, 255, 0.3);
  border-radius: 50%;
  border-top: 4px solid var(--primary);
  width: 40px;
  height: 40px;
  animation: spin 1s linear infinite;
  margin: 10px auto;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
</style>
</head>

<body>

<!-- ===== BACKGROUND ELEMENTS ===== -->
<div class="particles" id="particles"></div>

<!-- ===== CUSTOM MODAL ===== -->
<div class="custom-modal" id="forceModal">
  <div class="modal-content">
    <h2>√Çyyyy!</h2>
    <p>B·∫°n <span style="color: var(--primary); font-weight: bold;">ƒê·ªÉ nh∆∞ v·∫≠y cho vui th√¥i"</span> ƒë·ª´ng t√°y m√°y ;))!</p>
    <p style="font-size: 1rem; color: #777; margin-top: 15px;">
      kkkkkkkkkkkkkkk 
    </p>
    <button class="modal-close" onclick="closeForceModal()">z√©t s∆°!</button>
  </div>
</div>

<!-- ===== SUCCESS MODAL ===== -->
<div class="custom-modal" id="successModal">
  <div class="modal-content">
    <h2>Good!</h2>
    <p>OK!</p>
    <div class="spinner" style="display: none;" id="submitSpinner"></div>
    <button class="modal-close" onclick="closeSuccessModal()">ƒê√≥ng</button>
  </div>
</div>

<!-- ===== ERROR MODAL ===== -->
<div class="custom-modal" id="errorModal">
  <div class="modal-content">
    <h2>‚ö†Ô∏è C√≥ l·ªói x·∫£y ra</h2>
    <p id="errorMessage">Kh√¥ng th·ªÉ g·ª≠i th√¥ng tin. Vui l√≤ng th·ª≠ l·∫°i!</p>
    <button class="modal-close" onclick="closeErrorModal()">ƒê√≥ng</button>
  </div>
</div>

<!-- ===== AUDIO ELEMENTS ===== -->
<audio id="bgm" loop>
  <source src="https://assets.mixkit.co/music/preview/mixkit-happy-birthday-493.mp3" type="audio/mpeg">
</audio>
<audio id="soundEffect" preload="auto"></audio>

<!-- ===== SCREEN 1: WELCOME ===== -->
<div class="screen" id="screen1">
  <div class="emoji-container">
    <div class="animated-emoji">üê∂</div>
    <div class="animated-emoji">üéÇ</div>
    <div class="animated-emoji">üéâ</div>
  </div>
  
  <h1 class="glow-text">Snvv nh√≥e ;00!</h1>
  
  <div class="from">
    <span>From:</span>
    <b style="color: var(--primary)"> ch√∫a t·ªÉ lo√†i v∆∞·ª£n c·ªï </b>
  </div>
  
  <div class="message">
    5 years ago hmm, so fast huh? Time flies!
  </div>
  
  <div class="progress-container">
    <div class="progress-bar" id="progressBar"></div>
  </div>
  
  <div class="button-group">
    <button onclick="createConfetti()" class="secondary">
      Spammm thisss
    </button>
    <button onclick="openGift()">
      N√©ct
    </button>
  </div>
</div>

<!-- ===== SCREEN 2: GIFT ===== -->
<div class="screen hidden" id="screen2">
  <h1>Ohh, you gotta do this ;))</h1>
  
  <div class="message">
    Ommm t ƒë·ªãnh t·∫∑ng m m·ªôt c√°i g√¨ ƒë√≥,nh∆∞ng ph√¢n v√¢n qu√° l√¢u.
    n√™n ƒë·ªãnh t·∫∑ng m 1 quy·ªÉn s√°ch m√† l·∫°i ph√¢n v√¢n k bi·∫øt lo·∫°i s√°ch g√¨,v·∫≠y n√™n 
    m ghi th·ªÉ lo·∫°i s√°ch m th√≠ch ƒëi, t s·∫Ω t·∫∑ng m quy·ªÉn s√°ch theo th·ªÉ lo·∫°i ƒë√≥ nha ;))
  </div>
  
  <div class="input-group">
    <input id="bookInput" 
           placeholder="üìö Nh·∫≠p ƒë√™" 
           autocomplete="off">
  </div>
  
  <div class="button-group">
    <button onclick="showForceModal()" class="secondary">
      Kh√¥ng ghi :)
    </button>
    <button onclick="submitToGoogleForm()" id="submitButton">
      G·ª≠i & N·∫Ωt
    </button>
  </div>
</div>

<!-- ===== SCREEN 3: RESULT ===== -->
<div class="screen hidden" id="screen3">
  <h1>OKKK!</h1>
  
  <div id="resultContent">
    <!-- Dynamic content will be loaded here -->
  </div>
  
  <div class="emoji-container" style="margin: 40px 0">
    <div class="animated-emoji">üéÇ</div>
    <div class="animated-emoji">üéà</div>
    <div class="animated-emoji">üéÅ</div>
  </div>
  
  <button onclick="resetToStart()" class="secondary">
    ALRIGHT!
  </button>
</div>

<script>
// ===== GOOGLE FORM CONFIGURATION =====
// THAY ƒê·ªîI C√ÅC GI√Å TR·ªä N√ÄY THEO FORM C·ª¶A B·∫†N
const GOOGLE_FORM_CONFIG = {
  // ID c·ªßa Google Form (l·∫•y t·ª´ URL: https://docs.google.com/forms/d/e/{FORM_ID}/viewform)
  formId: "1FAIpQLSf9WI408WMOCyTLq_ansDAazkJWZOR6rL2NnArRcSJxaMhCKA",
  
  // Entry IDs c·ªßa c√°c tr∆∞·ªùng (xem h∆∞·ªõng d·∫´n b√™n d∆∞·ªõi ƒë·ªÉ l·∫•y)
  entryIds: {
    bookPreference: "entry.1858201258", // Thay b·∫±ng entry ID th·ª±c t·∫ø
    timestamp: "entry.1858201258"       // Thay b·∫±ng entry ID th·ª±c t·∫ø
  }
};

/**
 * H∆Ø·ªöNG D·∫™N L·∫§Y ENTRY ID:
 * 1. T·∫°o Google Form v·ªõi c√°c tr∆∞·ªùng b·∫°n c·∫ßn
 * 2. Chuy·ªÉn ƒë·∫øn ch·∫ø ƒë·ªô xem m√£ ngu·ªìn c·ªßa form
 * 3. T√¨m c√°c th·∫ª input c√≥ name b·∫Øt ƒë·∫ßu b·∫±ng "entry."
 * 4. V√≠ d·ª•: <input type="text" name="entry.1234567890">
 * 5. S·ªë "1234567890" ch√≠nh l√† entry ID
 */

// ===== INITIALIZATION =====
let userPreference = '';
let hasPlayedMusic = false;

// Create background particles
function createParticles() {
  const container = document.getElementById('particles');
  for (let i = 0; i < 50; i++) {
    const particle = document.createElement('div');
    particle.className = 'particle';
    particle.style.width = `${Math.random() * 20 + 5}px`;
    particle.style.height = particle.style.width;
    particle.style.left = `${Math.random() * 100}vw`;
    particle.style.animationDelay = `${Math.random() * 20}s`;
    particle.style.animationDuration = `${Math.random() * 20 + 10}s`;
    particle.style.background = `hsl(${Math.random() * 360}, 100%, 65%)`;
    container.appendChild(particle);
  }
}

// Create floating hearts
function createHearts() {
  for (let i = 0; i < 20; i++) {
    setTimeout(() => {
      const heart = document.createElement('div');
      heart.className = 'floating-heart';
      heart.innerHTML = 'ü¶ä';
      heart.style.left = `${Math.random() * 100}vw`;
      heart.style.animationDuration = `${Math.random() * 10 + 10}s`;
      document.body.appendChild(heart);
      
      setTimeout(() => heart.remove(), 15000);
    }, i * 300);
  }
}

// ===== MODAL FUNCTIONS =====
function showForceModal() {
  playSoundEffect('https://assets.mixkit.co/sfx/preview/mixkit-warning-alarm-buzzer-1551.mp3');
  
  const modal = document.getElementById('forceModal');
  modal.classList.add('active');
  
  // Add some shake effect to the button
  const button = document.querySelector('button.secondary');
  button.style.animation = 'shake 0.5s';
  setTimeout(() => {
    button.style.animation = '';
  }, 500);
  
  // Add CSS for shake animation
  if (!document.querySelector('#shake-style')) {
    const style = document.createElement('style');
    style.id = 'shake-style';
    style.textContent = `
      @keyframes shake {
        0%, 100% { transform: translateX(0); }
        10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
        20%, 40%, 60%, 80% { transform: translateX(5px); }
      }
    `;
    document.head.appendChild(style);
  }
}

function closeForceModal() {
  playSoundEffect('https://assets.mixkit.co/sfx/preview/mixkit-plastic-bubble-click-1124.mp3');
  
  const modal = document.getElementById('forceModal');
  modal.classList.remove('active');
}

function showSuccessModal() {
  const modal = document.getElementById('successModal');
  modal.classList.add('active');
}

function closeSuccessModal() {
  const modal = document.getElementById('successModal');
  modal.classList.remove('active');
}

function showErrorModal(message) {
  document.getElementById('errorMessage').textContent = message;
  const modal = document.getElementById('errorModal');
  modal.classList.add('active');
}

function closeErrorModal() {
  const modal = document.getElementById('errorModal');
  modal.classList.remove('active');
}

// ===== GOOGLE FORM SUBMISSION =====
async function submitToGoogleForm() {
  userPreference = document.getElementById('bookInput').value.trim();
  
  // Validation
  if (!userPreference) {
    playSoundEffect('https://assets.mixkit.co/sfx/preview/mixkit-game-show-wrong-answer-buzz-950.mp3');
    
    const input = document.getElementById('bookInput');
    input.style.animation = 'shake 0.5s';
    input.placeholder = "üìù GHI ƒêI B·∫†N OIIIIIII";
    input.style.boxShadow = '0 0 0 3px #ff4d6d';
    
    setTimeout(() => {
      input.style.animation = '';
      input.style.boxShadow = '';
      input.placeholder = "üìö Th·ªÉ lo·∫°i s√°ch b·∫°n y√™u th√≠ch...";
    }, 1000);
    
    return;
  }
  
  // Show loading
  const submitButton = document.getElementById('submitButton');
  const originalText = submitButton.textContent;
  submitButton.textContent = "ƒêang g·ª≠i...";
  submitButton.disabled = true;
  
  try {
    // Prepare form data
    const formData = new FormData();
    formData.append(GOOGLE_FORM_CONFIG.entryIds.bookPreference, userPreference);
    formData.append(GOOGLE_FORM_CONFIG.entryIds.timestamp, new Date().toISOString());
    
    // Submit to Google Form
    const response = await fetch(
      `https://docs.google.com/forms/d/e/${GOOGLE_FORM_CONFIG.formId}/formResponse`,
      {
        method: 'POST',
        mode: 'no-cors', // Google Forms doesn't support CORS
        body: formData
      }
    );
    
    // Since we use 'no-cors', we can't check the response status
    // But we assume it's successful if no error thrown
    
    // Success!
    playSoundEffect('https://assets.mixkit.co/sfx/preview/mixkit-winning-chimes-2015.mp3');
    
    // Show success message
    showSuccessModal();
    
    // Continue to next screen
    setTimeout(() => {
      closeSuccessModal();
      showSurprise();
    }, 2000);
    
  } catch (error) {
    console.error('Error submitting to Google Form:', error);
    
    // Show error but still continue (in case user wants to try offline)
    showErrorModal("L·ªói k·∫øt n·ªëi, nh∆∞ng ·ª©ng d·ª•ng v·∫´n ti·∫øp t·ª•c!");
    playSoundEffect('https://assets.mixkit.co/sfx/preview/mixkit-warning-alarm-buzzer-1551.mp3');
    
    // Still continue to next screen
    setTimeout(() => {
      closeErrorModal();
      showSurprise();
    }, 2000);
    
  } finally {
    // Restore button
    submitButton.textContent = originalText;
    submitButton.disabled = false;
  }
}

// ===== AUDIO MANAGEMENT =====
function playBackgroundMusic() {
  if (hasPlayedMusic) return;
  
  const audio = document.getElementById('bgm');
  audio.volume = 0.5;
  
  // Try to play with user interaction
  const playPromise = audio.play();
  
  if (playPromise !== undefined) {
    playPromise.then(() => {
      hasPlayedMusic = true;
      // Fade in
      let fadeIn = setInterval(() => {
        audio.volume = Math.min(0.7, audio.volume + 0.1);
        if (audio.volume >= 0.7) clearInterval(fadeIn);
      }, 200);
    }).catch(e => {
      console.log("Autoplay blocked, waiting for interaction");
    });
  }
}

function playSoundEffect(url) {
  const audio = document.getElementById('soundEffect');
  audio.src = url;
  audio.volume = 0.3;
  audio.play().catch(e => console.log("Sound effect error:", e));
}

// ===== EFFECTS =====
function createConfetti() {
  playSoundEffect('https://assets.mixkit.co/sfx/preview/mixkit-party-horn-sound-2927.mp3');
  
  for (let i = 0; i < 150; i++) {
    setTimeout(() => {
      const confetti = document.createElement('div');
      confetti.className = 'confetti';
      confetti.style.left = `${Math.random() * 100}vw`;
      confetti.style.background = `hsl(${Math.random() * 360}, 100%, 60%)`;
      confetti.style.width = `${Math.random() * 20 + 8}px`;
      confetti.style.height = confetti.style.width;
      confetti.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
      confetti.style.animationDuration = `${Math.random() * 3 + 2}s`;
      document.body.appendChild(confetti);
      
      setTimeout(() => confetti.remove(), 5000);
    }, i * 20);
  }
}

// ===== NAVIGATION =====
function openGift() {
  playSoundEffect('https://assets.mixkit.co/sfx/preview/mixkit-unlock-game-notification-253.mp3');
  playBackgroundMusic();
  
  document.getElementById('screen1').classList.add('hidden');
  document.getElementById('screen2').classList.remove('hidden');
  
  // Animate progress bar
  const progressBar = document.getElementById('progressBar');
  progressBar.style.width = '50%';
}

function showSurprise() {
  playSoundEffect('https://assets.mixkit.co/sfx/preview/mixkit-winning-chimes-2015.mp3');
  
  document.getElementById('screen2').classList.add('hidden');
  document.getElementById('screen3').classList.remove('hidden');
  
  // Update result content
  const resultContent = document.getElementById('resultContent');
  resultContent.innerHTML = `
    <div class="message" style="margin-bottom: 30px;">
      <p>üéØ <b>COMFIRMED:</b> ${userPreference}</p>
      <p style="margin-top: 15px; font-size: 1.2em;">
        b·∫°n t·∫∑ng nh√©,ƒë·ª´ng ng·∫°i g√¨ nh√© :))!
      </p>
    </div>
    <div style="background: linear-gradient(135deg, rgba(255,77,109,0.1), rgba(123,104,238,0.1)); 
                padding: 25px; border-radius: 20px; margin: 20px 0;">
      <h3 style="color: var(--accent); margin-bottom: 15px;">L·ªùi nh·∫Øn t·ª´ ch√∫a t·ªÉ lo√†i v∆∞·ª£n c·ªï:</h3>
      <p style="font-size: 1.1em; color: #555;">
        "All the best!"
      </p>
    </div>
  `;
  
  // Complete progress bar
  const progressBar = document.getElementById('progressBar');
  progressBar.style.width = '100%';
  
  // Create more hearts
  createHearts();
  
  // Auto create confetti
  setTimeout(() => createConfetti(), 500);
}

function resetToStart() {
  playSoundEffect('https://assets.mixkit.co/sfx/preview/mixkit-plastic-bubble-click-1124.mp3');
  
  document.getElementById('screen3').classList.add('hidden');
  document.getElementById('screen1').classList.remove('hidden');
  
  // Reset progress bar
  const progressBar = document.getElementById('progressBar');
  progressBar.style.width = '0%';
  
  // Reset input
  document.getElementById('bookInput').value = '';
  userPreference = '';
}

// ===== ENTER KEY SUPPORT =====
document.getElementById('bookInput').addEventListener('keypress', (e) => {
  if (e.key === 'Enter') submitToGoogleForm();
});

// ===== TOUCH/MOUSE INTERACTIONS =====
document.addEventListener('click', () => {
  playBackgroundMusic();
});

// ===== INITIALIZE =====
window.addEventListener('DOMContentLoaded', () => {
  createParticles();
  createHearts();
  
  // Auto-play music after 2 seconds if user hasn't interacted
  setTimeout(() => {
    if (!hasPlayedMusic) {
      playBackgroundMusic();
    }
  }, 2000);
});

// ===== ADDITIONAL FEATURE: CLICK EMOJIS =====
document.addEventListener('click', (e) => {
  if (e.target.classList.contains('animated-emoji')) {
    const emoji = e.target.textContent;
    playSoundEffect('https://assets.mixkit.co/sfx/preview/mixkit-cartoon-toy-whistle-616.mp3');
    
    // Create floating emoji
    const floating = document.createElement('div');
    floating.textContent = emoji;
    floating.style.position = 'fixed';
    floating.style.fontSize = '40px';
    floating.style.left = `${e.clientX}px`;
    floating.style.top = `${e.clientY}px`;
    floating.style.pointerEvents = 'none';
    floating.style.zIndex = '1000';
    floating.style.animation = 'bounce2 1s forwards';
    document.body.appendChild(floating);
    
    setTimeout(() => floating.remove(), 1000);
  }
});

// Close modal when clicking outside
const modals = ['forceModal', 'successModal', 'errorModal'];
modals.forEach(modalId => {
  const modal = document.getElementById(modalId);
  if (modal) {
    modal.addEventListener('click', function(e) {
      if (e.target === this) {
        if (modalId === 'forceModal') closeForceModal();
        if (modalId === 'successModal') closeSuccessModal();
        if (modalId === 'errorModal') closeErrorModal();
      }
    });
  }
});
</script>

</body>
</html>




