<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Happy Birthday ğŸ¶ğŸ‚</title>
<style>
body{
    margin:0;
    font-family:'Comic Sans MS',sans-serif;
    background:linear-gradient(135deg,#ffe6f0,#e6f7ff);
    overflow:hidden;
    text-align:center;
}
.screen{
    position:absolute;
    inset:0;
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
}
.hidden{display:none;}
button{
    padding:15px 30px;
    margin:10px;
    border:none;
    border-radius:30px;
    font-size:1.1em;
    cursor:pointer;
    background:#ff90b3;
    color:white;
}
.big{font-size:1.4em;background:#ff4d6d;}
canvas{
    background:#fff;
    border:4px dashed #ff90b3;
    border-radius:20px;
}
input,textarea{
    padding:15px;
    font-size:1em;
    border-radius:15px;
    border:2px solid #ff4d6d;
    width:300px;
}
.explode{animation:boom 1s forwards;}
@keyframes boom{
    to{transform:scale(5);opacity:0;}
}
</style>
</head>
<body>

<!-- MUSIC -->
<audio id="music" loop>
  <source src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_8c2c6a9d7a.mp3">
</audio>

<!-- SCREEN 1 -->
<div class="screen" id="screen1">
  <h1>ğŸ‰ ChÃºc má»«ng sinh nháº­t ğŸ‰</h1>
  <p>Muá»‘n má»Ÿ quÃ  thÃ¬ giÃºp chÃ³ vá» Ä‘Ã­ch ğŸ¶ğŸ</p>
  <button onclick="toggleMusic()">ğŸµ Báº­t / Táº¯t nháº¡c</button>
  <button class="big" onclick="startGame()">ğŸ• ChÆ¡i game</button>
</div>

<!-- GAME -->
<div class="screen hidden" id="gameScreen">
  <h2>SPACE / cháº¡m Ä‘á»ƒ nháº£y</h2>
  <canvas id="game" width="600" height="200"></canvas>
</div>

<!-- BOOK -->
<div class="screen hidden" id="giftScreen">
  <h2>ğŸ“š Ghi 1 thá»ƒ loáº¡i sÃ¡ch báº¡n thÃ­ch</h2>
  <input id="book" placeholder="VD: Tiá»ƒu thuyáº¿t...">
  <div>
    <button onclick="submitBook()">Gá»­i</button>
    <button onclick="alert('ğŸ˜ˆ KhÃ´ng cÃ³ chuyá»‡n Ä‘Ã³ Ä‘Ã¢u!')">KhÃ´ng ghi gÃ¬</button>
  </div>
</div>

<!-- MESSAGE INPUT -->
<div class="screen hidden" id="messageInputScreen">
  <h2>ğŸ’Œ Báº¡n cÃ³ muá»‘n Ä‘á»ƒ láº¡i lá»i nháº¯n cho ngÆ°á»i nÃ y khÃ´ng?</h2>
  <textarea id="guestMessage" placeholder="Viáº¿t gÃ¬ Ä‘Ã³ dá»… thÆ°Æ¡ng nha~"></textarea>
  <div>
    <button onclick="submitGuestMessage()">Gá»­i lá»i nháº¯n</button>
    <button onclick="skipGuestMessage()">Bá» qua</button>
  </div>
</div>

<!-- FINAL -->
<div class="screen hidden" id="finalMessageScreen"></div>

<script>
/* ===== GOOGLE FORM ===== */
const FORM_ID = "FORM_ID_CUA_BAN";
const ENTRY_ID = "123456789";

function sendToGoogleForm(message){
  const url=`https://docs.google.com/forms/d/e/${FORM_ID}/formResponse`;
  const data=new URLSearchParams();
  data.append(entry.${ENTRY_ID},message);
  fetch(url,{method:"POST",mode:"no-cors",body:data});
}

/* ===== MUSIC ===== */
function toggleMusic(){
  const m=document.getElementById("music");
  m.paused?m.play():m.pause();
}

/* ===== GAME ===== */
const c=document.getElementById("game");
const ctx=c.getContext("2d");
let dog={x:50,y:150,vy:0};
let obs={x:600};
let playing=false;

function startGame(){
  screen1.classList.add("hidden");
  gameScreen.classList.remove("hidden");
  playing=true;
  loop();
}
function loop(){
  if(!playing) return;
  ctx.clearRect(0,0,600,200);
  dog.vy+=0.8; dog.y+=dog.vy;
  if(dog.y>150){dog.y=150;dog.vy=0;}
  obs.x-=4; if(obs.x<0) obs.x=600;
  ctx.font="40px serif";
  ctx.fillText("ğŸ¶",dog.x,dog.y);
  ctx.fillText("ğŸªµ",obs.x,160);
  ctx.fillText("ğŸ",520,160);
  if(obs.x<dog.x+30 && obs.x>dog.x-30 && dog.y>130){
    alert("ğŸ’¥ Thua rá»“i!");
    obs.x=600;
  }
  if(dog.x>500){
    playing=false;
    gameScreen.classList.add("hidden");
    giftScreen.classList.remove("hidden");
    return;
  }
  dog.x+=1;
  requestAnimationFrame(loop);
}
addEventListener("keydown",e=>{
  if(e.code==="Space"&&dog.y>=150) dog.vy=-12;
});
addEventListener("touchstart",()=>{
  if(dog.y>=150) dog.vy=-12;
});

/* ===== BOOK ===== */
function submitBook(){
  if(!book.value.trim()){
    alert("ğŸ“š Ghi vÃ o Ä‘i mÃ ~"); return;
  }
  giftScreen.classList.add("explode");
  setTimeout(()=>{
    giftScreen.classList.add("hidden");
    messageInputScreen.classList.remove("hidden");
  },600);
}

/* ===== MESSAGE ===== */
const defaultMessage=`ğŸ’Œ Lá»i nháº¯n dÃ nh cho báº¡n

ChÃºc má»«ng sinh nháº­t ğŸ‚
Mong lÃ  hÃ´m nay báº¡n tháº¥y mÃ¬nh Ä‘Æ°á»£c yÃªu thÆ°Æ¡ng.
Cá»© lÃ  báº¡n thÃ´i, tháº¿ lÃ  Ä‘á»§ rá»“i ğŸ¶âœ¨`;

function submitGuestMessage(){
  const msg=guestMessage.value.trim();
  if(!msg){alert("ğŸ’Œ Viáº¿t vÃ i dÃ²ng nha~");return;}
  sendToGoogleForm(msg);
  showFinal(msg);
}
function skipGuestMessage(){
  showFinal(defaultMessage);
}
function showFinal(text){
  messageInputScreen.classList.add("hidden");
  finalMessageScreen.classList.remove("hidden");
  finalMessageScreen.innerHTML=`
    <h1>ğŸ’– Má»™t lá»i nháº¯n cho báº¡n</h1>
    <p style="white-space:pre-line;max-width:500px;font-size:1.2em;">
      ${text}
    </p>
    <div style="font-size:50px;">ğŸ¶ğŸ’—ğŸ¶</div>`;
}
</script>

</body>
</html>
